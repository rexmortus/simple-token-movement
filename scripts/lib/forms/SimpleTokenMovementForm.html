<!-- Nav -->
<nav class="token-controller-tabs tabs" data-group="primary-tabs">
  <a class="item" data-tab="movement-tab" data-group="primary-tabs">üß≠</a>
  <a class="item" data-tab="actions-tab" data-group="primary-tabs">üî•</a>
  <a class="item" data-tab="abilities-skills-tab" data-group="primary-tabs">üé≤</a>
  <a class="item" data-tab="spellcasting-tab" data-group="primary-tabs">ü™Ñ</a>
  <a class="item" data-tab="inventory-tab" data-group="primary-tabs">üéí</a>
  <a class="item" data-tab="character-tab" data-group="primary-tabs">üë§</a>
</nav>

<section class="container token-controller-content">
  
  <div class="scrollable-div">
      
  <!-- Movement tab -->
  <div class="tab" data-tab="movement-tab" data-group="primary-tabs">
    <h3>Movement</h3>
    <div class="token-controller-grid">
      <div class="mtmc-topleft">‚ÜñÔ∏è</div>
      <div class="mtmc-top">‚¨ÜÔ∏è</div>
      <div class="mtmc-topright">‚ÜóÔ∏è</div>
      <div class="mtmc-left">‚¨ÖÔ∏è</div>
      <div class="mtmc-select"><img src="{{character.prototypeToken.texture.src}}" class="character-image" alt=""></div>
      <div class="mtmc-right">‚û°Ô∏è</div>
      <div class="mtmc-bottomleft">‚ÜôÔ∏è</div>
      <div class="mtmc-bottom">‚¨áÔ∏è</div>
      <div class="mtmc-bottomright">‚ÜòÔ∏è</div>  
    </div>
  </div>

  <!-- Actions tab -->
  <div class="tab" data-tab="actions-tab" data-group="primary-tabs">
    <div class="simple-token-controller-actions">

      {{#checklength actionList.action.size 0}}
        <h3 class="items-header">Actions</h3>
        <table>
          {{#each actionList.action}}
            <tr class="token-controller-action" data-event-type="action" data-action-subtype="action" data-action-index="{{@index}}">
              <td><img src="{{this.img}}" alt="" height="32px" width="32px"></td>
              <td>{{this.name}}</td>
              <td>{{this.labels.activation}}</td>
              <td style="text-align: center;">
                {{#if this.labels.toHit}} {{this.labels.toHit}} to hit <br>{{/if}}
                {{#each this.labels.derivedDamage}}
                  {{this.label}}
                {{/each}}
              </td>
            </tr>
          {{/each}}
        </table>
      {{/checklength}}

      
      {{#checklength actionList.bonus.size 0}}
        <h3>Bonus</h3>
        <table>
          {{#each actionList.bonus}}
            <tr class="token-controller-action" data-event-type="action" data-action-subtype="bonus" data-action-index="{{@index}}">
              <td><img src="{{this.img}}" alt="" height="32px" width="32px"></td>
              <td>{{this.name}}</td>
              <td>{{this.labels.activation}}</td>
            </tr>
          {{/each}}
        </table>
      {{/checklength}}

      {{#checklength actionList.crew.size 0}}
        <h3>Crew</h3>
        <table>
          {{#each actionList.crew}}
            <tr class="token-controller-action" data-event-type="action" data-action-subtype="crew" data-action-index="{{@index}}">
              <td><img src="{{this.img}}" alt="" height="32px" width="32px"></td>
              <td>{{this.name}}</td>
              <td>{{this.labels.activation}}</td>
            </tr>
          {{/each}}
        </table>
      {{/checklength}}

      {{#checklength actionList.lair.size 0}}
        <h3>Lair</h3>
        <table>
          {{#each actionList.lair}}
            <tr class="token-controller-action" data-event-type="action" data-action-subtype="lair" data-action-index="{{@index}}">
              <td><img src="{{this.img}}" alt="" height="32px" width="32px"></td>
              <td>{{this.name}}</td>
              <td>{{this.labels.activation}}</td>
            </tr>
          {{/each}}
        </table>
      {{/checklength}}

      {{#checklength actionList.legendary.size 0}}
        <h3>Legendary</h3>
        <table>
          {{#each actionList.legendary}}
            <tr class="token-controller-action" data-event-type="action" data-action-subtype="legendary" data-action-index="{{@index}}">
              <td><img src="{{this.img}}" alt="" height="32px" width="32px"></td>
              <td>{{this.name}}</td>
              <td>{{this.labels.activation}}</td>
            </tr>
          {{/each}}
        </table>
      {{/checklength}}

      {{#checklength actionList.other.size 0}}
        <h3>Other</h3>
        <table>
          {{#each actionList.other}}
            <tr class="token-controller-action" data-event-type="action" data-action-subtype="other" data-action-index="{{@index}}">
              <td><img src="{{this.img}}" alt="" height="32px" width="32px"></td>
              <td>{{this.name}}</td>
              <td>{{this.labels.activation}}</td>
            </tr>
          {{/each}}
        </table>
      {{/checklength}}

      {{#checklength actionList.reaction.size 0}}
        <h3>Reactions</h3>
        <table>
          {{#each actionList.reaction}}
            <tr class="token-controller-action" data-event-type="action" data-action-subtype="reaction" data-action-index="{{@index}}">
              <td><img src="{{this.img}}" alt="" height="32px" width="32px"></td>
              <td>{{this.name}}</td>
              <td>{{this.labels.activation}}</td>
            </tr>
          {{/each}}
        </table>
      {{/checklength}}
      
    </div>
  </div>

  <!-- Abilities / Skills tab -->
  <div class="tab" data-tab="abilities-skills-tab" data-group="primary-tabs">
    <h3>Abilities</h3>
    <table>
      <thead>
        <tr>
          <th>Ability</th>
          <th>Value</th>
          <th>Modifier</th>
          <th>Save</th>
        </tr>
      </thead>
      {{#each character.system.abilities}}
        <tr class="token-controller-action" data-event-type="ability" data-ability="{{@key}}" style="text-align: center; font-size:16px">
          <td style="text-align: left;">
            {{#with (lookup ../abilityList @key) }}
              {{label}}
            {{/with}}
          </td>
          <td>{{this.value}}</td>
          <td>{{this.mod}}</td>
          <td>{{this.save}}</td>
        </tr>
      {{/each}}
    </table>

    <!-- Skills -->
    <h3>Skills</h3>
    <table>
      <thead>
        <tr>
          <th>Skill</th>
          <th>Ability</th>
          <th>Total</th>
          <th>Passive</th>
        </tr>
      </thead>
      {{#each character.system.skills}}
        <tr class="token-controller-action" data-event-type="skill" data-skill="{{@key}}" style="text-align: center; font-size:16px">
          <td style="text-align: left;">
            {{#with (lookup ../skillList @key) }}
              {{label}}
            {{/with}}
          </td>
          <td>{{this.ability}} <span style="color: grey;">({{this.mod}})</span></td>
          <td>{{this.total}}</td>
          <td style="color: grey;">{{this.passive}}</td>
        </tr>
      {{/each}}
    </table>
  </div>

  <!-- Spellcasting tab-->
  <div class="tab" data-tab="spellcasting-tab" data-group="primary-tabs">
    <h3>Spellcasting</h3>
    
    <!-- Wizard -->
    {{#if isWizard}}
    <div class="flexrow" style="text-align: center;">
      <div><span style="font-size: x-large;">{{character.system.attributes.spellcasting}}</span><br>Ability</div>
      <div><span style="font-size: x-large;">{{character.system.attributes.spelldc}}</span><br>Spell DC</div>
      <div><span style="font-size: x-large;">{{numOfSpellsPrepared}} / {{maxPrepared}}</span><br>Spells Prepared</div>  
    </div>
    <br>
    {{/if}}

    <!-- Sorcerer -->

    <!-- Warlock -->

    <!-- Paladin -->

    <!-- Cleric -->

    <h3>Spellbook</h3>
    <table>
    {{#each spellList}}
      <table>
        <thead>
          <th>Level {{@key}}</th>
          <th></th>
          <th>
            {{#with (lookup ../spellSlots @key) }}
              {{#if this.max includeZero=true}}
                {{this.value}} / {{this.max}}  
              {{/if}}
            {{/with}}
          </th>
        </thead>
        {{#each this}}
        <tr class="token-controller-action" data-event-type="spell" data-spell-name="{{this.name}}">
          <td><img height="32px" width="32px" src="{{this.img}}" alt=""></td>
          <td>{{this.name}}</td>
          <td style="text-align: center;">
            {{#if this.system.preparation.prepared}}
            <i class="original-class fas fa-sun" data-tooltip="DND5E.ClassOriginal"></i>
            {{/if}}
          </td>
        </tr>
        {{/each}}
      </table>
    {{/each}}
    </table>
  </div>

  <!--Inventory tab-->
  <div class="tab" data-tab="inventory-tab" data-group="primary-tabs">
    <table>
      {{#each inventoryList}}
      <h3>{{@key}}</h3>
      <table>
        {{#each this}}
        <tr class="token-controller-action" style="text-align: left;">
          <td><img height="32px" width="32px" src="{{this.img}}" alt=""></td>
          <td style="text-align: left;">{{this.name}}</td>
        </tr>
        {{/each}}
      </table>
    {{/each}}
    </table>
  </div>

   <!--Character tab-->
   <div class="tab" data-tab="character-tab" data-group="primary-tabs">
    <h3>Attributes</h3>
    <div class="flexrow" style="text-align: center;">
      <div><span style="font-size: x-large;">{{character.system.attributes.hp.value}} / {{character.system.attributes.hp.max}}</span><br>HP</div>
      <div><span style="font-size: x-large;">{{character.system.attributes.ac.value}}</span><br>AC</div>
      <div><span style="font-size: x-large;">{{character.system.attributes.movement.walk}}</span><br>Movement</div>
      <div><span style="font-size: x-large;">{{character.system.attributes.init.total}}</span><br>Initiative</div>
    </div>
    {{#each featureList}}
    <h3>{{@key}}</h3>
    <table>
      {{#each this}}
      <tr class="token-controller-action" style="text-align: left;">
        <td><img height="32px" width="32px" src="{{this.img}}" alt=""></td>
        <td style="text-align: left;">{{this.name}}</td>
      </tr>
      {{/each}}
    </table>
  {{/each}}
  </div>


  </div>
</div>
